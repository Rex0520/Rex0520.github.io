<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Gradle构建工具 | Rex中心站</title>
<meta name="keywords" content="Build Tool" />
<meta name="description" content="Maven基础">
<meta name="author" content="Rex">
<link rel="canonical" href="https://rexhub.space/posts/back/java/build_tool/gradle/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.css" rel="preload stylesheet" as="style">
<link rel="preload" href="https://rexhub-1301356141.cos.ap-shanghai.myqcloud.com/profile/blog-icon.png" as="image">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://rexhub.space/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://rexhub.space/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://rexhub.space/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://rexhub.space/apple-touch-icon.png">
<link rel="mask-icon" href="https://rexhub.space/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.100.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Gradle构建工具" />
<meta property="og:description" content="Maven基础" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rexhub.space/posts/back/java/build_tool/gradle/" /><meta property="og:image" content="https://cdn.rexhub.xyz/img/20210820141535.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-26T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-10-26T00:00:00&#43;00:00" /><meta property="og:site_name" content="RexHub" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://cdn.rexhub.xyz/img/20210820141535.jpg"/>

<meta name="twitter:title" content="Gradle构建工具"/>
<meta name="twitter:description" content="Maven基础"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://rexhub.space/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Gradle构建工具",
      "item": "https://rexhub.space/posts/back/java/build_tool/gradle/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Gradle构建工具",
  "name": "Gradle构建工具",
  "description": "Maven基础",
  "keywords": [
    "Build Tool"
  ],
  "articleBody": "Gradle构建工具 身边有学习安卓的大佬强烈推荐我学习了解下Gradle这款构建工具，说是将会是未来的主流，所以来此学习并记录下。\n货比三家 Ant Maven Gradle 公司 Apache Apache Google 语言 xml xml Groovy 构建性能 速度最快 速度最低 中间 依赖管理 ivy管理 GAV管理 GNV管理 插件管理 简单 复杂 简单 侧重 小型项目构建 项目包管理 大型项目构建 流行程度(2022) 低 高 中（未来趋势） 总结：各有各的优缺点，虽然gradle结合了ant和maven的优点，但是现在的兼容性还比较查\n下载源配置 在gradle安转目录的init.d文件夹下新建一个init.gradle文件 init.gradle\nallprojects { repositories { mavenLocal() maven { name \"Alibaba\"; url \"https://maven.aliyun.com/repository/public\" } maven { name \"Spring\"; url \"https://repo.spring.io/libs-milestone/\" } mavenCentral() } buildscript { repositories { maven { name \"Alibaba\"; url 'https://maven.aliyun.com/repository/public' } maven { name \"Spring\"; url 'https://repo.spring.io/plugins-release/' } maven { name \"M2\"; url 'https://plugins.gradle.org/m2/' } } } } 说明（从上至下搜索）\nmavenLocal() 从本地maven找，需配置M2_HOME环境变量，变量值为maven地址 Alibaba 阿里下载源 mavenCentral() maven中央仓库 tip: 配置源参考阿里云官方 Gradle目录构结 目录 功能 /build 封装编译后的文件、测试报告 /gradle/wrapper/ 封装包装器文件夹 /src 速度最快｜ /gradlew mac/linux端包装器启动脚本 /gradlew.bat windows端包装器启动脚本 /build.gradle 构建脚本（类似maven的pom） /setting.gradle 设置项目信息 文件结构与maven极其相似🫤，都是基于约定大于配置（Convention over configuration）的设定\n**Gradle中的依赖(Dependencies) 依赖方式 直接依赖：依赖本地的某个jar包，具体可通过 文件集合、文件树的方式指定 项目依赖：依赖某个project 本地jar依赖：依赖的类型 依赖的组名 依赖的名称 依赖的版本号 dependencies { //直接依赖 implementation 'org.apache.logging.log4j:log4j:2.17.2' // 完整写法 implementation group: 'org.junit.jupiter', name: 'junit-jupiter-engine', version: '5.8.1' //依赖当前项目下的某个模块[子工程] implementation project(':subject01') //直接依赖本地的某个jar文件 implementation files('libs/foo.jar', 'libs/bar.jar') //配置某文件夹作为依赖项 implementation fileTree(dir: 'libs', include: ['*.jar']) } tips: 若项目中版本号是’+’/’latest.integration’表示下载最新版本, 最好是不用这种动态版本声明，容易出现版本问题\n依赖下载 执行gradle build会去配置的依赖仓库下载jar包\n依赖类型 类似maven中的scope\n类型 作用 compileOnly 由java插件提供,曾短暂的叫provided,后续版本已经改成了compileOnly,适用于编译期需要而不需要打包的情况 runtimeOnly 由 java 插件提供,只在运行期有效,编译时不需要,比如 mysql 驱动包。,取代老版本中被移除的runtime implementation 由 java 插件提供,针对源码[src/main 目录] ,在编译、运行时都有效,取代老版本中被移除的 compile testCompileOnly 由 java 插件提供,用于编译测试的依赖项，运行时不需要 testRuntimeOnly 由 java 插件提供,只在测试运行时需要，而不是在测试编译时需要,取代老版本中被移除的 testRuntime testImplementation 由 java 插件提供,针对测试代码[src/test 目录] 取代老版本中被移除的 testCompile providedCompile war 插件提供支持，编译、测试阶段代码需要依赖此类 jar 包，而运行阶段容器已经提供了相应的支持，所以无需将这些文件打入到 war 包中了;例如 servlet-api.jar、jsp-api.jar compile 编译范围依赖在所有的 classpath 中可用，同时它们也会被打包。在 gradle 7.0 已经移除 runtime runtime 依赖在运行和测试系统的时候需要,在编译的时候不需要,比如 mysql 驱动包。在 gradle 7.0 已经移除 api java-library 插件提供支持,这些依赖项可以传递性地导出给使用者，用于编译时和运行时。取代老版本中被移除的 compile compileOnlyApi java-library 插件提供支持,在声明模块和使用者在编译时需要的依赖项，但在运行时不需要。 官方： 各个依赖范围的关系和说明 依赖范围升级和移除 API和implemention区别 执行 java 命令时都使用了哪些依赖范围的依赖\ntips:\njava 插件提供的功能，java-library 插件都提供。 api与implementation的区别 编译时：api能实现底层传递，底层变，全部变，编译速度慢；implementation不能进行依赖传递，底层变，不用全部变，编译快 应用：api适用于多模块的场景，一般场景使用implementation 运行时所有模块的class都需要编译，api和implementation差不多 依赖冲突及解决方案 依赖冲突是指 “在编译过程中, 如果存在某个依赖的多个版本, 构建系统应该选择哪个进行构建的问题”\ngraph LR A[Project A] --\u003e B[Project B] A[Project A] --\u003e C[Project C] B --\u003e D[log4j 1.4.2] C --\u003e E[log4j 2.2.4] gradle默认会使用新版本。 如上图所示，gradle引入的1.4.2版本会被替换成2.2.4版本 可使用exclude，来移除依赖，不允许依赖传递，强制使用指定版本 implementation('org.hibernate:hibernate-core:3.6.3.Final'){ //下面三种都行 exclude group: 'org.slf4j' //exclude module: 'sl4j-api' //exclude group: 'org.slf4j', module: 'sl4j-api' } 配置不允许传递依赖(不建议)：transitive(false) implementation('org.hibernate:hibernate-core:3.6.3.Final'){ //不允许依赖传递，一般不用 transitive(false) } 强制使用指定版本的依赖 //强制使用某个版本!!【官方建议使用这种方式】 implementation('org.slf4j:slf4j-api:1.4.0!!') //这种效果和上面那种一样,强制指定某个版本 implementation('org.slf4j:slf4j-api:1.4.0'){ version{ strictly(\"1.4.0\") } } 任务执行 官方文档\n常用命令 命令 作用 gradle build 构建项目：编译、测试、打包 gradle run 运行一个自定义服务，需要application插件支持，并且指定了主启动类(mainClassName=xxx)才能运行 gradle clean 清空build目录 gradle init 初始化gradle项目使用 gradle wrapper 生成wrapper文件夹 gradle wrapper –gradle-version=x.x 升级 wrapper 版本号 gradle wrapper –gradle-version 5.2.1 –distribution-type all 关联源码用 gradle classes 编译业务代码和配置文件 gradle test 编译测试代码，生成测试报告｜ gradle build -x test 跳过测试构建 gradle [taskName] :执行自定义任务 项目报告相关任务 命令 作用 gradle projects 列出所选项目及子项目列表，以层次结构的形式显示 gradle tasks 列出所选项目【当前 project,不包含父、子】的已分配给任务组的那些任务 gradle tasks –all 列出所选项目的所有任务 gradle tasks –group=“build setup” 列出所选项目中指定分组中的任务 gradle help –task someTask 显示某个任务的详细信息 gradle dependencies 查看整个项目的依赖信息，以依赖树的方式显示 gradle properties 列出所选项目的属性列表 选项 调试常用选项 选项 作用 -h,–help 查看帮助信息 -v, –version 打印 Gradle、 Groovy、 Ant、 JVM 和操作系统版本信息 -S, –full-stacktrace 打印出所有异常的完整(非常详细)堆栈跟踪信息 -s,–stacktrace 打印出用户异常的堆栈跟踪(例如编译错误) -Dorg.gradle.daemon.debug=true 调试 Gradle 守护进程 -Dorg.gradle.debug=true 调试 Gradle 客户端(非 daemon)进程 -Dorg.gradle.debug.port=(port number) 指定启用调试时要侦听的端口号。默认值为 5005 性能选项 tips: 在gradle.properties中指定这些选项中的许多选项，因此不需要命令行标志\n选项 作用 –build-cache, –no-build-cache 尝试重用先前版本的输出。默认关闭(off) –max-workers 设置 Gradle 可以使用的 woker 数。默认值是处理器数 -parallel, –no-parallel 并行执行项目。有关此选项的限制，请参阅并行项目执行 守护进程选项 选项 作用 –daemon, –no-daemon 使用 Gradle 守护进程运行构建。默认是 on –foreground 在前台进程中启动 Gradle 守护进程。 -Dorg.gradle.daemon.idletimeout=(number of milliseconds) Gradle Daemon 将在这个空闲时间的毫秒数之后停止自己。默认值为 10800000(3 小时)。默认设置为关闭(off) 日志选项 选项 作用 -Dorg.gradle.logging.level=(quiet,warn,lifecycle,info,debug) 通过 Gradle 属性设置日志记录级别 -q, –quiet 只能记录错误信息 -w, –warn 设置日志级别为warn -i, –info 将日志级别设置为info -d, –debug 登录调试模式(包括正常的堆栈跟踪) 其他 选项 作用 -x -x 等价于: –exclude-task : 常见 gradle -x test clean build –rerun-tasks 强制执行任务，忽略 up-to-date ,常见 gradle build –rerun-tasks –continue 忽略前面失败的任务,继续执行,而不是在遇到第一个失败时立即停止执行。每个遇到的故障都将在构建结束时报告，常见：gradle build –continue。 gradle init –type pom 将 maven 项目转换为 gradle 项目(根目录执行) 拓展 gradle 任务名是缩写: 任务名支持驼峰式命名风格的任务名缩写，如：connectTask 简写为：cT,执行任务 gradle cT。 前面提到的 Gradle 指令本质:一个个的 task【任务】, Gradle 中所有操作都是基于任务完成的 Wrapper包装器 GradlerWrapper为解决没有gradle的环境下使用gradle项目的问题。只需要使用构建项目时生成的gradlew/gradlew.bat，需注意的是使用gradlew的命令需要依赖于jdk\n运行的依赖包在gradle/wrapper下 Gradle的使用方式和gradlew是一样的 可使用gradle wrapper指定参数控制wrapper版本（升级项目的gradle）， 参数 说明 –gradle-version 用于指定使用的Gradle版本 –gradle-distribution-url 用于指定下载Gradle发行的url地址 Groovy 概述 基于JVM的敏捷开发语言 是一种成熟的面向对象编程语言，既可以用于面向对象，也可以用作纯粹的脚本语言 适合与spring的动态语言一起使用，设计时充分考虑了Java的集成 基本语法 可以面向对象（写个类），也可以不面向对象（不写类） 可以混合类的定义和脚本的定义，但是定义的类名不能与文件名重名 使用def定义变量、方法，不建议使用具体的数据类型 可省略\",\"，以换行符作为结束 支持顺序、分支、循环结构 支持算数、关系、位、赋值运算符 基本数据类型也是对象 字符串分为单引号（作为字符串常量，没有运算能力）、双引号（可引用变量${}，有运算能力）、三引号（模板字符串，支持换行） 变量、属性、方法、闭包的参数可不写，使用的时候决定他的类型 如果一个groovy文件包含脚本信息，这个类编译的时候会默认继承Script类，这个类的名称为文件名，脚本内容被打包至run方法里，有main函数调用。若不包含脚本信息，groovy是个对象，则会实现GroovyObject接口。 对象 默认类、方法、属性是用public修饰的 属性属性操作 赋值 对象.属性 = xxx 对象.set属性(xxx)，不用自己定义get，set方法 具名构造器 读取 对象.属性 对象.get属性() 对象[“属性”] 对象的赋值、读取的本质都是getter、setter方法完成 方法 声明时返回值可省略，return关键字也可省略，默认返回最后一行的值 调用时，()可省略 Gradle测试 test { enabled(true) // build时执行同时进行测试，生成测试报告 useJUnitPlatform() //支持Junit5测试 // include(\"space/rexhub/bj/test/*\") // 测试指定包 exclude(\"space/rexhub/bj/test/*\") // 不测试指定包 } Gradle项目周期 Initialization Init Script: 执行init.gradle文件，包含仓库信息、仓库用户名密码等一些全局属性配置 Setting Script: 执行setting.gradle文件，构建参与项目的所有模块，setting.gradle包含项目信息 Configuration：按照层级结构执行各个项目中的build.gradle文件，并更具层级关系创建一个Task有向无环图 execution：执行各个task节点的任务 settings文件 作用：初始化阶段确定哪些工程需要加入到项目构建中，为构建项目工程树做准备。 工程树：类似maven的module 位置：必须在根工程下 名字：必须为setting.gradle 内容：定义当前项目以及子项目的项目名称 对应实例：与package org.gradle.api.initialization.Settings一一对应 使用：使用相对路径【:】引入子工程。子工程必须在setting中配置了才会被gradle识别 Task 项目实质上是Task 对象的集合。一个 Task 表示一个逻辑上较为独立的执行过程，比如编译 Java 源代码，拷贝文件，打包 Jar 文件，甚至可以是执行一个系统命令。另外，一个 Task 可以读取和设置 Project 的 Property 以完成特定的操作。\n简单使用 在build.gradle中 def map = Collections.singletonMap(\"action\", {println \"task one...\"}) //task(map, \"task1\", {}) task (map, \"task1\") { // 任务的配置段，在任务的配置阶段进行 println \"这是最简单的任务\" // 任务的行为：在任务执行阶段执行 doFirst{ println \"task1 do first\" } // doLast{ println \"task1 do last\" } } task1.doFirst { println \"task1 do first(outer)\" } task1.doLast { println \"task1 do first(outer)\" } 命令行执行gralde -i task1 输出 \u003e Configure .... 这是最简单的任务 .... \u003e Task :task1 .... task1 do first(outer) task1 do first task one... task1 do last task1 do first(outer) 任务定义方式 task(): task(‘A’, {…})、task ‘A’ {…}、task(‘A’){…} tasks对象的create()/register(): tasks.create(“E”){…}、tasks.register(\"…\") register: 延迟创建，只有task被调用的时候才会创建 tips: 可使用defaultTasks()定义任务(在没有指定其他任务时执行的默认任务) 任务的属性 属性 描述 默认值 type 基于一个存在的Task来创建，类似继承 DefaultTask overwrite 是否替换存在的Task，这个和type配合起来用 false dependsOn 配置任务的依赖 [] action 添加到任务中的一个Action或者一个闭包 null description 配置任务的描述 null group 配置任务的分组 null enable 任务是否开启 true timeout 任务执行的时间 (tasks never time out) onlyIf 任务断言, 如：myClean.onlyIf(!project.hasProperties(“clean”))，执行:gradle myClean -Pclean 才会调用myClean的方法 null Tasks的方法 方法 描述 用例 findByName 根据任务名查找 tasks.findByName(“myClean”).doFirst({…}) findByPath 根据任务路径查找 tasks.findByName(\":myClean\").doFirst({…}) addRule 处理任务不存在异常 tasks.addRule(“cleanRule”){String taskName -\u003e task(taskName){println “任务不存在”} } 原理分析 无论是定义任务自身的 action,还是添加的 doLast、doFirst 方法，其实底层都被放入到一个 Action 的 List中了，最初这个 action List 是空的，当我们设置了 action【任务自身的行为】,它先将 action 添加到列表中，此时列表中只有一个 action,后续执行 doFirst 的时候 doFirst 在 action 前面添加，执行 doLast 的时候 doLast 在 action 后面添加。doFirst永远添加在 actions List 的第一位，保证添加的 Action 在现有的 action List 元素的最前面；doLast 永远都是在 action List末尾添加，保证其添加的 Action 在现有的 action List 元素的最后面。一个往前面添加,一个往后面添加，最后这个 actionList 就按顺序形成了 doFirst、doSelf、doLast 三部分的 Actions,就达到 doFirst、doSelf、doLast 三部分的 Actions 顺序执行的目的\n任务的依赖方式：dependsOn 参数方式依赖 实例：\ntask A { doLast{ println \"TaskA...\" } } task B { doLast{ print \"TaskB...\" } } // 参数方式依赖：dependsOn后面用冒号 task 'C' (dependsOn: ['A', 'B']){ doLast { println \"TaskC...\" } } 输出：\n\u003e Task :A TaskA... \u003e Task :B TaskB... \u003e Task :C TaskC... 内部依赖 实例：\ntask 'A'{...} task 'B'{...} // 参数方式依赖 task 'C'{ // 内部依赖：dependsOn后面=号 dependsOn=['A', 'B'] doLast { println \"TaskC.\" } } 输出同上\n外部依赖 实例：\n// 外部依赖：可变参数可加可不加 task 'A'{...} task 'B'{...} // 参数方式依赖 task 'C'{...} C dependsOn('B', 'A') 输出同上\ntips：\n依赖支持跨项目依赖 当一个 Task 依赖多个 Task 的时候，被依赖的 Task 之间如果没有依赖关系，那么它们的执行顺序是随机的,并无影响 重复依赖的任务只会执行一次 任务类型。官方(更多点这) 常见任务类型 该类型任务的作用 Delete 删除文件或目录 Copy 将文件复制到目标目录中。此任务还可以在复制时重命名和筛选文件 CreateStartScripts 创建启动脚本 Exec 执行命令行进程 GenerateMavenPom 生成 Maven 模块描述符(POM)文件。 GradleBuild 执行 Gradle 构建 Jar 组装 JAR 归档文件 JavaCompile 编译 Java 源文件 Javadoc 为 Java 类生成 HTML API 文档 PublishToMavenRepository 将 MavenPublication 发布到 mavenartifactrepostal Tar 组装 TAR 存档文件 Test 执行 JUnit (3.8.x、4.x 或 5.x)或 TestNG 测试 Upload 将 Configuration 的构件上传到一组存储库 War 组装 WAR 档案 Zip 组装 ZIP 归档文件。默认是压缩 ZIP 的内容 自定义类型的Task 继承DefaultTask\nclass CustomTask extends DefaultTask { //@TaskAction表示Task本身要执行的方法 @TaskAction def doSelf(){ println \"Task自身在执行的in doSelf\" } } def myTask=task MyDefinitionTask (type: CustomTask) myTask.doFirst(){ println \"task 执行之前 执行的 doFirst方法\" } myTask.doLast(){ println \"task 执行之后 执行的 doLast方法\" } 指定Task执行顺序。官方 dependsOn 强依赖方式 通过Task输入输出 通过API指定执行顺序 动态分配功能。 可循环创建任务，可以使用它在运行时动态地向任务添加依赖项 4.times { counter -\u003e tasks.register(\"task$counter\") { doLast { println \"I'm task number $counter\" } } } tasks.named('task0') { dependsOn('task2', 'task3') } 插件 作用 添加任务【task】到项目中，从而帮助完成测试、编译、打包等 添加依赖配置到项目中。 向项目中拓展新的扩展属性、方法等 对项目进行一些约定，如应用 Java 插件后，约定 src/main/java 目录是我们的源代码存在位置，编译时编译这个目录下的 Java 源代码文件 分类 graph LR; A[gradle插件] --\u003e B[脚本插件] A --\u003e C[\"二进制插件(对象插件)\"] C --\u003e D[内部插件] C --\u003e E[第三方插件] C --\u003e F[自定义插件] D --\u003e G[apply方式] D --\u003e H[\"plugins DSL方式\"] G --\u003e I[\"apply(map具名参数)\"] G --\u003e J[\"apply闭包\"] E --\u003e K[传统使用方式] E --\u003e L[\"plugins DSL\"] K --\u003e M[\"1. 先引入依赖\"] K --\u003e N[\"2. 通过apply应用\"] F --\u003e O[构建过程中默认执行] 脚本插件 编写脚本文件 version.gradle ext{ company = \"Rexhub\" cfgs = [\"compileSdkVersion\":\"JavaVersion.VERSION_1_S\"] spring = [ version: '5.0.0' ] } 引入 task versionTask{ doLast{ println \"公司名称为：${company},JDK版本是${cfgs.compileSdkVersion},版本号是${spring.version}\" } } 执行脚本结果：\n\u003e Task :versionTask 公司名称为：Rexhub,JDK版本是JavaVersion.VERSION_1_S,版本号是5.0.0 tips: 脚本文件可以是本地的，也可以是网络上的\n内部插件 二进制插件（对象插件）就是实现了 org.gradle.api.Plugin 接口的插件，每个 Java Gradle 插件都有一个 plugin id。核心插件(gradle官方)\napply方式引入 apply(map具名参数) //plugin: '插件id/插件全类名/插件简类名' apply plugin: 'java' //map具名参数方式 apply(闭包) apply{ //plugin '插件id/插件全类名/插件简类名' plugin 'java' } plugins DSL plugins { id 'java' id 'application' } 第三方插件 传统方式 引入依赖 buildscript { ext { springBootVersion = \"2.3.3.RELEASE\" } repositories { mavenLocal() maven { url 'http://maven.aliyun.com/nexus/content/groups/public' } jcenter() } // 此处先引入插件 dependencies { classpath(\"org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}\") } } tips: 但是如果是第三方插件已经被托管在 https://plugins.gradle.org/ 网站上,就可以不用在buildscript里配置classpath依赖了 buildscript{}需要放在gradle文件最前面 通过apply应用 apply plugin: 'org.springframework.boot' //社区插件,需要事先引入，不必写版本号 plugins DSL plugins { id 'org.springframework.boot' version '2.4.1' } 自定义插件 项目内简单定义方式(这种方式一般不用) 官方文档\ninterface GreetingPluginExtension { Property\u003cString\u003e getMessage() Property\u003cString\u003e getGreeter() } class GreetingPlugin implements Plugin\u003cProject\u003e { void apply(Project project) { def extension = project.extensions.create('greeting', GreetingPluginExtension) project.task('hello') { doLast { println \"${extension.message.get()} from ${extension.greeter.get()}\" } } } } apply plugin: GreetingPlugin // Configure the extension using a DSL block greeting { message = 'Hi' greeter = 'Gradle' } buildSrc方式 buildSrc 是 Gradle 默认的插件目录，编译 Gradle 的时候会自动识别这个目录，将其中的代码编译为插件\n项目内方式 创建名为buildSrc的java module，在setting.gradle中移除included modules信息。只保留build.gradle和src/main目录 修改gradle中的内容 apply plugin: 'groovy' //必须 apply plugin: 'maven-publish' dependencies { implementation gradleApi() //必须 implementation localGroovy() //必须 } repositories { google() jcenter() mavenCentral() //必须 } //把项目入口设置为src/main/groovy sourceSets { main { groovy { srcDir 'src/main/groovy' } } } 在src中创建入口目录，如：space.rexhub 在入口目录中创建插件，如：Text.groovy package space.rexhub import org.gradle.api.Plugin import org.gradle.api.Project /** * Description: Text插件 * @author Rex * @date 2022-11-06 15:26 */ class Text implements Plugin\u003cProject\u003e{ @Override void apply(Project project) { project.task(\"rexhub\"){ doLast { println \"自定义插件使用\" } } } } 创建main/resources/META-INF/gradle-plugins目录，在这个目录下创建properties，文件名为插件id 在properties文件中指名插件的全类名 implementation-class=space.rexhub.Text tips: 这种方式可以跨模块调用，但仅限于本工程\n将项目上传至maven的方式 基于上述步骤改进\n将buildSrc复制一份并重命名，如：rexhub，在setting.gradle引入 修改rexhub中的build.gradle文件，发布到仓库中 apply plugin: 'groovy' //必须 apply plugin: 'maven-publish' dependencies { implementation gradleApi() //必须 implementation localGroovy() //必须 } repositories { google() jcenter() mavenCentral() //必须 } //把项目入口设置为src/main/groovy sourceSets { main { groovy { srcDir 'src/main/groovy' } } } publishing { publications { myLibrary(MavenPublication) { groupId = 'space.rexhub.plugin' //指定GAV坐标信息 artifactId = 'library' version = '1.1' from components.java//发布jar包 //from components.web///引入war插件，发布war包 } } repositories { maven { url \"$rootDir/lib/release\" } //发布项目到私服中 // maven { // name = 'myRepo' //name属性可选,表示仓库名称，url必填 // //发布地址:可以是本地仓库或者maven私服 // //url = layout.buildDirectory.dir(\"repo\") // //url='http://my.org/repo' // // change URLs to point to your repos, e.g. http://my.org/repo // //认证信息:用户名和密码 // credentials { // username = 'joe' // password = 'secret' // } // } } } 执行 publish 指令,发布到根 project 或者 maven 私服仓库。 使用：在项目级 build.gradle 文件中将插件添加到 classpath buildscript { repositories { maven { url \"$rootDir/lib/release\" } } dependencies { classpath \"space.rexhub.plugin:library:1.1\" } } plugins{ id 'java' id 'space.rexhub.plugin' } 执行 gradle build 指令就会在控制台看到自定义插件的输出，说明自定义插件就已经生效了 ",
  "wordCount" : "1492",
  "inLanguage": "en",
  "datePublished": "2022-10-26T00:00:00Z",
  "dateModified": "2022-10-26T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Rex"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://rexhub.space/posts/back/java/build_tool/gradle/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Rex中心站",
    "logo": {
      "@type": "ImageObject",
      "url": "https://rexhub.space/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://rexhub.space/" accesskey="h" title="Home (Alt + H)">
                <img src="https://rexhub-1301356141.cos.ap-shanghai.myqcloud.com/profile/blog-icon.png" alt="logo" aria-label="logo"
                    height="35">Home</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://rexhub.space/posts/" title="文章">
                    <span>文章</span>
                </a>
            </li>
            <li>
                <a href="https://rexhub.space/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://rexhub.space/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://rexhub.space/archives/" title="时间轴">
                    <span>时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://rexhub.space/search/" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header><main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://rexhub.space/">Home</a>&nbsp;»&nbsp;<a href="https://rexhub.space/posts/">Posts</a></div>
    <h1 class="post-title">
      Gradle构建工具
    </h1>
    <div class="post-description">
      Maven基础
    </div>
    <div class="post-meta">2022-10-26&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Rex
</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#gradle%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7" aria-label="Gradle构建工具">Gradle构建工具</a><ul>
                        
                <li>
                    <a href="#%e8%b4%a7%e6%af%94%e4%b8%89%e5%ae%b6" aria-label="货比三家">货比三家</a></li>
                <li>
                    <a href="#%e4%b8%8b%e8%bd%bd%e6%ba%90%e9%85%8d%e7%bd%ae" aria-label="下载源配置">下载源配置</a></li>
                <li>
                    <a href="#gradle%e7%9b%ae%e5%bd%95%e6%9e%84%e7%bb%93" aria-label="Gradle目录构结">Gradle目录构结</a></li>
                <li>
                    <a href="#gradle%e4%b8%ad%e7%9a%84%e4%be%9d%e8%b5%96dependencies" aria-label="**Gradle中的依赖(Dependencies)">**Gradle中的依赖(Dependencies)</a><ul>
                        
                <li>
                    <a href="#%e4%be%9d%e8%b5%96%e6%96%b9%e5%bc%8f" aria-label="依赖方式">依赖方式</a></li>
                <li>
                    <a href="#%e4%be%9d%e8%b5%96%e4%b8%8b%e8%bd%bd" aria-label="依赖下载">依赖下载</a></li>
                <li>
                    <a href="#%e4%be%9d%e8%b5%96%e7%b1%bb%e5%9e%8b" aria-label="依赖类型">依赖类型</a></li>
                <li>
                    <a href="#%e4%be%9d%e8%b5%96%e5%86%b2%e7%aa%81%e5%8f%8a%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88" aria-label="依赖冲突及解决方案">依赖冲突及解决方案</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%bb%bb%e5%8a%a1%e6%89%a7%e8%a1%8c" aria-label="任务执行">任务执行</a><ul>
                        
                <li>
                    <a href="#%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4" aria-label="常用命令">常用命令</a></li>
                <li>
                    <a href="#%e9%a1%b9%e7%9b%ae%e6%8a%a5%e5%91%8a%e7%9b%b8%e5%85%b3%e4%bb%bb%e5%8a%a1" aria-label="项目报告相关任务">项目报告相关任务</a></li>
                <li>
                    <a href="#%e9%80%89%e9%a1%b9" aria-label="选项">选项</a><ul>
                        
                <li>
                    <a href="#%e8%b0%83%e8%af%95%e5%b8%b8%e7%94%a8%e9%80%89%e9%a1%b9" aria-label="调试常用选项">调试常用选项</a></li>
                <li>
                    <a href="#%e6%80%a7%e8%83%bd%e9%80%89%e9%a1%b9" aria-label="性能选项">性能选项</a></li>
                <li>
                    <a href="#%e5%ae%88%e6%8a%a4%e8%bf%9b%e7%a8%8b%e9%80%89%e9%a1%b9" aria-label="守护进程选项">守护进程选项</a></li>
                <li>
                    <a href="#%e6%97%a5%e5%bf%97%e9%80%89%e9%a1%b9" aria-label="日志选项">日志选项</a></li>
                <li>
                    <a href="#%e5%85%b6%e4%bb%96" aria-label="其他">其他</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%8b%93%e5%b1%95" aria-label="拓展">拓展</a></li></ul>
                </li>
                <li>
                    <a href="#wrapper%e5%8c%85%e8%a3%85%e5%99%a8" aria-label="Wrapper包装器">Wrapper包装器</a><ul>
                        
                <li>
                    <a href="#groovy" aria-label="Groovy">Groovy</a><ul>
                        
                <li>
                    <a href="#%e6%a6%82%e8%bf%b0" aria-label="概述">概述</a></li>
                <li>
                    <a href="#%e5%9f%ba%e6%9c%ac%e8%af%ad%e6%b3%95" aria-label="基本语法">基本语法</a></li>
                <li>
                    <a href="#%e5%af%b9%e8%b1%a1" aria-label="对象">对象</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#gradle%e6%b5%8b%e8%af%95" aria-label="Gradle测试">Gradle测试</a></li>
                <li>
                    <a href="#gradle%e9%a1%b9%e7%9b%ae%e5%91%a8%e6%9c%9f" aria-label="Gradle项目周期">Gradle项目周期</a></li>
                <li>
                    <a href="#settings%e6%96%87%e4%bb%b6" aria-label="settings文件">settings文件</a></li>
                <li>
                    <a href="#task" aria-label="Task">Task</a><ul>
                        
                <li>
                    <a href="#%e7%ae%80%e5%8d%95%e4%bd%bf%e7%94%a8" aria-label="简单使用">简单使用</a></li>
                <li>
                    <a href="#%e4%bb%bb%e5%8a%a1%e5%ae%9a%e4%b9%89%e6%96%b9%e5%bc%8f" aria-label="任务定义方式">任务定义方式</a></li>
                <li>
                    <a href="#%e4%bb%bb%e5%8a%a1%e7%9a%84%e5%b1%9e%e6%80%a7" aria-label="任务的属性">任务的属性</a></li>
                <li>
                    <a href="#tasks%e7%9a%84%e6%96%b9%e6%b3%95" aria-label="Tasks的方法">Tasks的方法</a></li>
                <li>
                    <a href="#%e5%8e%9f%e7%90%86%e5%88%86%e6%9e%90" aria-label="原理分析">原理分析</a></li>
                <li>
                    <a href="#%e4%bb%bb%e5%8a%a1%e7%9a%84%e4%be%9d%e8%b5%96%e6%96%b9%e5%bc%8fdependson" aria-label="任务的依赖方式：dependsOn">任务的依赖方式：dependsOn</a></li>
                <li>
                    <a href="#%e4%bb%bb%e5%8a%a1%e7%b1%bb%e5%9e%8b%e5%ae%98%e6%96%b9%e6%9b%b4%e5%a4%9a%e7%82%b9%e8%bf%99httpsdocsgradleorgcurrentdslindexhtmln104d4" aria-label="任务类型。官方(更多点这)">任务类型。<a href="https://docs.gradle.org/current/dsl/index.html#N104D4">官方(更多点这)</a></a><ul>
                        
                <li>
                    <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89%e7%b1%bb%e5%9e%8b%e7%9a%84task" aria-label="自定义类型的Task">自定义类型的Task</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%8c%87%e5%ae%9atask%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%ae%98%e6%96%b9httpsdocsgradleorgcurrentdslorggradleapitaskhtmln18aa8" aria-label="指定Task执行顺序。官方">指定Task执行顺序。<a href="https://docs.gradle.org/current/dsl/org.gradle.api.Task.html#N18AA8">官方</a></a></li>
                <li>
                    <a href="#%e5%8a%a8%e6%80%81%e5%88%86%e9%85%8d%e5%8a%9f%e8%83%bd" aria-label="动态分配功能。">动态分配功能。</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%8f%92%e4%bb%b6" aria-label="插件">插件</a><ul>
                        
                <li>
                    <a href="#%e4%bd%9c%e7%94%a8" aria-label="作用">作用</a></li>
                <li>
                    <a href="#%e5%88%86%e7%b1%bb" aria-label="分类">分类</a><ul>
                        
                <li>
                    <a href="#%e8%84%9a%e6%9c%ac%e6%8f%92%e4%bb%b6" aria-label="脚本插件">脚本插件</a></li>
                <li>
                    <a href="#%e5%86%85%e9%83%a8%e6%8f%92%e4%bb%b6" aria-label="内部插件">内部插件</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%ac%ac%e4%b8%89%e6%96%b9%e6%8f%92%e4%bb%b6" aria-label="第三方插件">第三方插件</a></li>
                <li>
                    <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89%e6%8f%92%e4%bb%b6" aria-label="自定义插件">自定义插件</a><ul>
                        
                <li>
                    <a href="#%e9%a1%b9%e7%9b%ae%e5%86%85%e7%ae%80%e5%8d%95%e5%ae%9a%e4%b9%89%e6%96%b9%e5%bc%8f%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e4%b8%80%e8%88%ac%e4%b8%8d%e7%94%a8" aria-label="项目内简单定义方式(这种方式一般不用)">项目内简单定义方式(这种方式一般不用)</a></li>
                <li>
                    <a href="#buildsrc%e6%96%b9%e5%bc%8f" aria-label="buildSrc方式">buildSrc方式</a><ul>
                        
                <li>
                    <a href="#%e9%a1%b9%e7%9b%ae%e5%86%85%e6%96%b9%e5%bc%8f" aria-label="项目内方式">项目内方式</a></li>
                <li>
                    <a href="#%e5%b0%86%e9%a1%b9%e7%9b%ae%e4%b8%8a%e4%bc%a0%e8%87%b3maven%e7%9a%84%e6%96%b9%e5%bc%8f" aria-label="将项目上传至maven的方式">将项目上传至maven的方式</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="gradle构建工具">Gradle构建工具<a hidden class="anchor" aria-hidden="true" href="#gradle构建工具">#</a></h1>
<blockquote>
<p>身边有学习安卓的大佬强烈推荐我学习了解下Gradle这款构建工具，说是将会是未来的主流，所以来此学习并记录下。</p>
</blockquote>
<h2 id="货比三家">货比三家<a hidden class="anchor" aria-hidden="true" href="#货比三家">#</a></h2>
<table>
<thead>
<tr>
<th></th>
<th>Ant</th>
<th>Maven</th>
<th>Gradle</th>
</tr>
</thead>
<tbody>
<tr>
<td>公司</td>
<td>Apache</td>
<td>Apache</td>
<td>Google</td>
</tr>
<tr>
<td>语言</td>
<td>xml</td>
<td>xml</td>
<td>Groovy</td>
</tr>
<tr>
<td>构建性能</td>
<td>速度最快</td>
<td>速度最低</td>
<td>中间</td>
</tr>
<tr>
<td>依赖管理</td>
<td>ivy管理</td>
<td>GAV管理</td>
<td>GNV管理</td>
</tr>
<tr>
<td>插件管理</td>
<td>简单</td>
<td>复杂</td>
<td>简单</td>
</tr>
<tr>
<td>侧重</td>
<td>小型项目构建</td>
<td>项目包管理</td>
<td>大型项目构建</td>
</tr>
<tr>
<td>流行程度(2022)</td>
<td>低</td>
<td>高</td>
<td>中（未来趋势）</td>
</tr>
</tbody>
</table>
<p>总结：各有各的优缺点，虽然gradle结合了ant和maven的优点，但是现在的兼容性还比较查</p>
<h2 id="下载源配置">下载源配置<a hidden class="anchor" aria-hidden="true" href="#下载源配置">#</a></h2>
<p>在gradle安转目录的init.d文件夹下新建一个init.gradle文件
init.gradle</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">allprojects</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">repositories</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">mavenLocal</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">maven</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">name</span> <span class="s2">&#34;Alibaba&#34;</span><span class="o">;</span> 
</span></span><span class="line"><span class="cl">      <span class="n">url</span> <span class="s2">&#34;https://maven.aliyun.com/repository/public&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">maven</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">name</span> <span class="s2">&#34;Spring&#34;</span><span class="o">;</span> 
</span></span><span class="line"><span class="cl">      <span class="n">url</span> <span class="s2">&#34;https://repo.spring.io/libs-milestone/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">mavenCentral</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="n">buildscript</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">repositories</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">maven</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span> <span class="s2">&#34;Alibaba&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="s1">&#39;https://maven.aliyun.com/repository/public&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">maven</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span> <span class="s2">&#34;Spring&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="s1">&#39;https://repo.spring.io/plugins-release/&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">maven</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span> <span class="s2">&#34;M2&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="s1">&#39;https://plugins.gradle.org/m2/&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>说明（从上至下搜索）</p>
<ul>
<li>mavenLocal() 从本地maven找，需配置M2_HOME环境变量，变量值为maven地址</li>
<li>Alibaba 阿里下载源</li>
<li>mavenCentral() maven中央仓库
tip: <a href="https://developer.aliyun.com/mvn/guide">配置源参考阿里云官方</a></li>
</ul>
<h2 id="gradle目录构结">Gradle目录构结<a hidden class="anchor" aria-hidden="true" href="#gradle目录构结">#</a></h2>
<table>
<thead>
<tr>
<th>目录</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>/build</td>
<td>封装编译后的文件、测试报告</td>
</tr>
<tr>
<td>/gradle/wrapper/</td>
<td>封装包装器文件夹</td>
</tr>
<tr>
<td>/src</td>
<td>速度最快｜</td>
</tr>
<tr>
<td>/gradlew</td>
<td>mac/linux端包装器启动脚本</td>
</tr>
<tr>
<td>/gradlew.bat</td>
<td>windows端包装器启动脚本</td>
</tr>
<tr>
<td>/build.gradle</td>
<td>构建脚本（类似maven的pom）</td>
</tr>
<tr>
<td>/setting.gradle</td>
<td>设置项目信息</td>
</tr>
</tbody>
</table>
<p>文件结构与maven极其相似🫤，都是基于约定大于配置（Convention over configuration）的设定</p>
<h2 id="gradle中的依赖dependencies">**Gradle中的依赖(Dependencies)<a hidden class="anchor" aria-hidden="true" href="#gradle中的依赖dependencies">#</a></h2>
<h3 id="依赖方式">依赖方式<a hidden class="anchor" aria-hidden="true" href="#依赖方式">#</a></h3>
<ul>
<li>直接依赖：依赖本地的某个jar包，具体可通过 文件集合、文件树的方式指定</li>
<li>项目依赖：依赖某个project</li>
<li>本地jar依赖：依赖的类型 依赖的组名 依赖的名称 依赖的版本号</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">dependencies</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//直接依赖
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">implementation</span> <span class="s1">&#39;org.apache.logging.log4j:log4j:2.17.2&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 完整写法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">implementation</span> <span class="nl">group:</span> <span class="s1">&#39;org.junit.jupiter&#39;</span><span class="o">,</span> <span class="nl">name:</span> <span class="s1">&#39;junit-jupiter-engine&#39;</span><span class="o">,</span> <span class="nl">version:</span> <span class="s1">&#39;5.8.1&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//依赖当前项目下的某个模块[子工程]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">implementation</span> <span class="nf">project</span><span class="o">(</span><span class="s1">&#39;:subject01&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//直接依赖本地的某个jar文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">implementation</span> <span class="nf">files</span><span class="o">(</span><span class="s1">&#39;libs/foo.jar&#39;</span><span class="o">,</span> <span class="s1">&#39;libs/bar.jar&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//配置某文件夹作为依赖项
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">implementation</span> <span class="nf">fileTree</span><span class="o">(</span><span class="nl">dir:</span> <span class="s1">&#39;libs&#39;</span><span class="o">,</span> <span class="nl">include:</span> <span class="o">[</span><span class="s1">&#39;*.jar&#39;</span><span class="o">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>tips: 若项目中版本号是&rsquo;+&rsquo;/&rsquo;latest.integration&rsquo;表示下载最新版本, 最好是不用这种动态版本声明，容易出现版本问题</p>
<h3 id="依赖下载">依赖下载<a hidden class="anchor" aria-hidden="true" href="#依赖下载">#</a></h3>
<p>执行gradle build会去配置的依赖仓库下载jar包</p>
<h3 id="依赖类型">依赖类型<a hidden class="anchor" aria-hidden="true" href="#依赖类型">#</a></h3>
<p>类似maven中的scope</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>compileOnly</strong></td>
<td>由java插件提供,曾短暂的叫provided,后续版本已经改成了compileOnly,适用于编译期需要而不需要打包的情况</td>
</tr>
<tr>
<td><strong>runtimeOnly</strong></td>
<td>由 java 插件提供,只在运行期有效,编译时不需要,比如 mysql 驱动包。,取代老版本中被移除的runtime</td>
</tr>
<tr>
<td><strong>implementation</strong></td>
<td>由 java 插件提供,针对源码[src/main 目录] ,在编译、运行时都有效,取代老版本中被移除的 compile</td>
</tr>
<tr>
<td>testCompileOnly</td>
<td>由 java 插件提供,用于编译测试的依赖项，运行时不需要</td>
</tr>
<tr>
<td>testRuntimeOnly</td>
<td>由 java 插件提供,只在测试运行时需要，而不是在测试编译时需要,取代老版本中被移除的 testRuntime</td>
</tr>
<tr>
<td>testImplementation</td>
<td>由 java 插件提供,针对测试代码[src/test 目录] 取代老版本中被移除的 testCompile</td>
</tr>
<tr>
<td>providedCompile</td>
<td>war 插件提供支持，编译、测试阶段代码需要依赖此类 jar 包，而运行阶段容器已经提供了相应的支持，所以无需将这些文件打入到 war 包中了;例如 servlet-api.jar、jsp-api.jar</td>
</tr>
<tr>
<td><del>compile</del></td>
<td>编译范围依赖在所有的 classpath 中可用，同时它们也会被打包。在 gradle 7.0 已经移除</td>
</tr>
<tr>
<td><del>runtime</del></td>
<td>runtime 依赖在运行和测试系统的时候需要,在编译的时候不需要,比如 mysql 驱动包。在 gradle 7.0 已经移除</td>
</tr>
<tr>
<td>api</td>
<td>java-library 插件提供支持,这些依赖项可以传递性地导出给使用者，用于编译时和运行时。取代老版本中被移除的 compile</td>
</tr>
<tr>
<td>compileOnlyApi</td>
<td>java-library 插件提供支持,在声明模块和使用者在编译时需要的依赖项，但在运行时不需要。</td>
</tr>
</tbody>
</table>
<p>官方：
<a href="https://docs.gradle.org/current/userguide/java_library_plugin.html#java_library_plugin">各个依赖范围的关系和说明</a>
<a href="https://docs.gradle.org/current/userguide/upgrading_version_6.html#sec:configuration_removal">依赖范围升级和移除</a>
<a href="https://docs.gradle.org/current/userguide/java_library_plugin.html#java_library_plugin">API和implemention区别</a>
<a href="https://docs.gradle.org/current/userguide/java_plugin.html#java_plugin:">执行 java 命令时都使用了哪些依赖范围的依赖</a></p>
<p>tips:</p>
<ol>
<li>java 插件提供的功能，java-library 插件都提供。</li>
<li>api与implementation的区别
<ol>
<li><strong>编译时</strong>：api能实现底层传递，底层变，全部变，编译速度慢；implementation不能进行依赖传递，底层变，不用全部变，编译快</li>
<li><strong>应用</strong>：api适用于多模块的场景，一般场景使用implementation</li>
<li><strong>运行时</strong>所有模块的class都需要编译，api和implementation差不多</li>
</ol>
</li>
</ol>
<h3 id="依赖冲突及解决方案">依赖冲突及解决方案<a hidden class="anchor" aria-hidden="true" href="#依赖冲突及解决方案">#</a></h3>
<blockquote>
<p>依赖冲突是指 &ldquo;在编译过程中, 如果存在某个依赖的多个版本, 构建系统应该选择哪个进行构建的问题&rdquo;</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">graph LR
</span></span><span class="line"><span class="cl">A[Project A] --&gt; B[Project B]
</span></span><span class="line"><span class="cl">A[Project A] --&gt; C[Project C]
</span></span><span class="line"><span class="cl">B --&gt; D[log4j 1.4.2]
</span></span><span class="line"><span class="cl">C --&gt; E[log4j 2.2.4]
</span></span></code></pre></div><ul>
<li>gradle默认会使用新版本。 如上图所示，gradle引入的1.4.2版本会被替换成2.2.4版本</li>
<li>可使用exclude，来移除依赖，不允许依赖传递，强制使用指定版本
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl">    <span class="n">implementation</span><span class="o">(</span><span class="s1">&#39;org.hibernate:hibernate-core:3.6.3.Final&#39;</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">     <span class="c1">//下面三种都行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">exclude</span> <span class="nl">group:</span> <span class="s1">&#39;org.slf4j&#39;</span>
</span></span><span class="line"><span class="cl">     <span class="c1">//exclude module: &#39;sl4j-api&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="c1">//exclude group: &#39;org.slf4j&#39;, module: &#39;sl4j-api&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="o">}</span>
</span></span></code></pre></div></li>
<li>配置不允许传递依赖(不建议)：transitive(false)
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl">  <span class="n">implementation</span><span class="o">(</span><span class="s1">&#39;org.hibernate:hibernate-core:3.6.3.Final&#39;</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//不允许依赖传递，一般不用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">transitive</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span></code></pre></div></li>
<li>强制使用指定版本的依赖
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="c1">//强制使用某个版本!!【官方建议使用这种方式】
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">implementation</span><span class="o">(</span><span class="s1">&#39;org.slf4j:slf4j-api:1.4.0!!&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">//这种效果和上面那种一样,强制指定某个版本
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">implementation</span><span class="o">(</span><span class="s1">&#39;org.slf4j:slf4j-api:1.4.0&#39;</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">  <span class="n">version</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">strictly</span><span class="o">(</span><span class="s2">&#34;1.4.0&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></li>
</ul>
<h2 id="任务执行">任务执行<a hidden class="anchor" aria-hidden="true" href="#任务执行">#</a></h2>
<p><a href="https://docs.gradle.org/current/userguide/command_line_interface.html">官方文档</a></p>
<h3 id="常用命令">常用命令<a hidden class="anchor" aria-hidden="true" href="#常用命令">#</a></h3>
<table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>gradle build</td>
<td>构建项目：编译、测试、打包</td>
</tr>
<tr>
<td>gradle run</td>
<td>运行一个自定义服务，需要application插件支持，并且指定了主启动类(mainClassName=xxx)才能运行</td>
</tr>
<tr>
<td>gradle clean</td>
<td>清空build目录</td>
</tr>
<tr>
<td>gradle init</td>
<td>初始化gradle项目使用</td>
</tr>
<tr>
<td>gradle wrapper</td>
<td>生成wrapper文件夹</td>
</tr>
<tr>
<td>gradle wrapper &ndash;gradle-version=x.x</td>
<td>升级 wrapper 版本号</td>
</tr>
<tr>
<td>gradle wrapper &ndash;gradle-version 5.2.1 &ndash;distribution-type all</td>
<td>关联源码用</td>
</tr>
<tr>
<td>gradle classes</td>
<td>编译业务代码和配置文件</td>
</tr>
<tr>
<td>gradle test</td>
<td>编译测试代码，生成测试报告｜</td>
</tr>
<tr>
<td>gradle build -x test</td>
<td>跳过测试构建</td>
</tr>
<tr>
<td>gradle [taskName] :执行自定义任务</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="项目报告相关任务">项目报告相关任务<a hidden class="anchor" aria-hidden="true" href="#项目报告相关任务">#</a></h3>
<table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>gradle projects</td>
<td>列出所选项目及子项目列表，以层次结构的形式显示</td>
</tr>
<tr>
<td>gradle tasks</td>
<td>列出所选项目【当前 project,不包含父、子】的已分配给任务组的那些任务</td>
</tr>
<tr>
<td>gradle tasks &ndash;all</td>
<td>列出所选项目的所有任务</td>
</tr>
<tr>
<td>gradle tasks &ndash;group=&ldquo;build setup&rdquo;</td>
<td>列出所选项目中指定分组中的任务</td>
</tr>
<tr>
<td>gradle help &ndash;task someTask</td>
<td>显示某个任务的详细信息</td>
</tr>
<tr>
<td>gradle dependencies</td>
<td>查看整个项目的依赖信息，以依赖树的方式显示</td>
</tr>
<tr>
<td>gradle properties</td>
<td>列出所选项目的属性列表</td>
</tr>
</tbody>
</table>
<h3 id="选项">选项<a hidden class="anchor" aria-hidden="true" href="#选项">#</a></h3>
<h4 id="调试常用选项">调试常用选项<a hidden class="anchor" aria-hidden="true" href="#调试常用选项">#</a></h4>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-h,&ndash;help</td>
<td>查看帮助信息</td>
</tr>
<tr>
<td>-v, &ndash;version</td>
<td>打印 Gradle、 Groovy、 Ant、 JVM 和操作系统版本信息</td>
</tr>
<tr>
<td>-S, &ndash;full-stacktrace</td>
<td>打印出所有异常的完整(非常详细)堆栈跟踪信息</td>
</tr>
<tr>
<td>-s,&ndash;stacktrace</td>
<td>打印出用户异常的堆栈跟踪(例如编译错误)</td>
</tr>
<tr>
<td>-Dorg.gradle.daemon.debug=true</td>
<td>调试 Gradle 守护进程</td>
</tr>
<tr>
<td>-Dorg.gradle.debug=true</td>
<td>调试 Gradle 客户端(非 daemon)进程</td>
</tr>
<tr>
<td>-Dorg.gradle.debug.port=(port number)</td>
<td>指定启用调试时要侦听的端口号。默认值为 5005</td>
</tr>
</tbody>
</table>
<h4 id="性能选项">性能选项<a hidden class="anchor" aria-hidden="true" href="#性能选项">#</a></h4>
<p>tips: 在gradle.properties中指定这些选项中的许多选项，因此不需要命令行标志</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;build-cache, &ndash;no-build-cache</td>
<td>尝试重用先前版本的输出。默认关闭(off)</td>
</tr>
<tr>
<td>&ndash;max-workers</td>
<td>设置 Gradle 可以使用的 woker 数。默认值是处理器数</td>
</tr>
<tr>
<td>-parallel, &ndash;no-parallel</td>
<td>并行执行项目。有关此选项的限制，请参阅并行项目执行</td>
</tr>
</tbody>
</table>
<h4 id="守护进程选项">守护进程选项<a hidden class="anchor" aria-hidden="true" href="#守护进程选项">#</a></h4>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;daemon, &ndash;no-daemon</td>
<td>使用 Gradle 守护进程运行构建。默认是 on</td>
</tr>
<tr>
<td>&ndash;foreground</td>
<td>在前台进程中启动 Gradle 守护进程。</td>
</tr>
<tr>
<td>-Dorg.gradle.daemon.idletimeout=(number of milliseconds)</td>
<td>Gradle Daemon 将在这个空闲时间的毫秒数之后停止自己。默认值为 10800000(3 小时)。默认设置为关闭(off)</td>
</tr>
</tbody>
</table>
<h4 id="日志选项">日志选项<a hidden class="anchor" aria-hidden="true" href="#日志选项">#</a></h4>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-Dorg.gradle.logging.level=(quiet,warn,lifecycle,info,debug)</td>
<td>通过 Gradle 属性设置日志记录级别</td>
</tr>
<tr>
<td>-q, &ndash;quiet</td>
<td>只能记录错误信息</td>
</tr>
<tr>
<td>-w, &ndash;warn</td>
<td>设置日志级别为warn</td>
</tr>
<tr>
<td>-i, &ndash;info</td>
<td>将日志级别设置为info</td>
</tr>
<tr>
<td>-d, &ndash;debug</td>
<td>登录调试模式(包括正常的堆栈跟踪)</td>
</tr>
</tbody>
</table>
<h4 id="其他">其他<a hidden class="anchor" aria-hidden="true" href="#其他">#</a></h4>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-x</td>
<td>-x 等价于: &ndash;exclude-task : 常见 gradle -x test clean build</td>
</tr>
<tr>
<td>&ndash;rerun-tasks</td>
<td>强制执行任务，忽略 up-to-date ,常见 gradle build &ndash;rerun-tasks</td>
</tr>
<tr>
<td>&ndash;continue</td>
<td>忽略前面失败的任务,继续执行,而不是在遇到第一个失败时立即停止执行。每个遇到的故障都将在构建结束时报告，常见：gradle build &ndash;continue。</td>
</tr>
<tr>
<td>gradle init &ndash;type pom</td>
<td>将 maven 项目转换为 gradle 项目(根目录执行)</td>
</tr>
</tbody>
</table>
<h3 id="拓展">拓展<a hidden class="anchor" aria-hidden="true" href="#拓展">#</a></h3>
<ul>
<li>gradle 任务名是缩写: 任务名支持驼峰式命名风格的任务名缩写，如：connectTask 简写为：cT,执行任务 gradle cT。</li>
<li>前面提到的 Gradle 指令本质:一个个的 task【任务】, Gradle 中所有操作都是基于任务完成的</li>
</ul>
<h2 id="wrapper包装器">Wrapper包装器<a hidden class="anchor" aria-hidden="true" href="#wrapper包装器">#</a></h2>
<blockquote>
<p>GradlerWrapper为解决没有gradle的环境下使用gradle项目的问题。只需要使用构建项目时生成的gradlew/gradlew.bat，需注意的是使用gradlew的命令需要依赖于jdk</p>
</blockquote>
<ul>
<li>运行的依赖包在gradle/wrapper下</li>
<li>Gradle的使用方式和gradlew是一样的</li>
<li>可使用gradle wrapper指定参数控制wrapper版本（升级项目的gradle），
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;gradle-version</td>
<td>用于指定使用的Gradle版本</td>
</tr>
<tr>
<td>&ndash;gradle-distribution-url</td>
<td>用于指定下载Gradle发行的url地址</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="groovy">Groovy<a hidden class="anchor" aria-hidden="true" href="#groovy">#</a></h3>
<h4 id="概述">概述<a hidden class="anchor" aria-hidden="true" href="#概述">#</a></h4>
<ul>
<li>基于JVM的敏捷开发语言</li>
<li>是一种成熟的面向对象编程语言，既可以用于面向对象，也可以用作纯粹的脚本语言</li>
<li>适合与spring的动态语言一起使用，设计时充分考虑了Java的集成</li>
</ul>
<h4 id="基本语法">基本语法<a hidden class="anchor" aria-hidden="true" href="#基本语法">#</a></h4>
<ul>
<li>可以面向对象（写个类），也可以不面向对象（不写类）</li>
<li>可以混合类的定义和脚本的定义，但是定义的类名不能与文件名重名</li>
<li>使用def定义变量、方法，不建议使用具体的数据类型</li>
<li>可省略&quot;,&quot;，以换行符作为结束</li>
<li>支持顺序、分支、循环结构</li>
<li>支持算数、关系、位、赋值运算符</li>
<li>基本数据类型也是对象</li>
<li>字符串分为单引号（作为字符串常量，没有运算能力）、双引号（可引用变量${}，有运算能力）、三引号（模板字符串，支持换行）</li>
<li>变量、属性、方法、闭包的参数可不写，使用的时候决定他的类型</li>
<li>如果一个groovy文件包含脚本信息，这个类编译的时候会默认继承Script类，这个类的名称为文件名，脚本内容被打包至run方法里，有main函数调用。若不包含脚本信息，groovy是个对象，则会实现GroovyObject接口。</li>
</ul>
<h4 id="对象">对象<a hidden class="anchor" aria-hidden="true" href="#对象">#</a></h4>
<ul>
<li>默认类、方法、属性是用public修饰的</li>
<li>属性属性操作
<ul>
<li>赋值
<ul>
<li>对象.属性 = xxx</li>
<li>对象.set属性(xxx)，不用自己定义get，set方法</li>
<li>具名构造器</li>
</ul>
</li>
<li>读取
<ul>
<li>对象.属性</li>
<li>对象.get属性()</li>
<li>对象[&ldquo;属性&rdquo;]</li>
</ul>
</li>
<li>对象的赋值、读取的本质都是getter、setter方法完成</li>
</ul>
</li>
<li>方法
<ul>
<li>声明时返回值可省略，return关键字也可省略，默认返回最后一行的值</li>
<li>调用时，()可省略</li>
</ul>
</li>
</ul>
<h2 id="gradle测试">Gradle测试<a hidden class="anchor" aria-hidden="true" href="#gradle测试">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">test</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">enabled</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="c1">// build时执行同时进行测试，生成测试报告
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">useJUnitPlatform</span><span class="o">()</span> <span class="c1">//支持Junit5测试
</span></span></span><span class="line"><span class="cl"><span class="c1">//    include(&#34;space/rexhub/bj/test/*&#34;) // 测试指定包
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">exclude</span><span class="o">(</span><span class="s2">&#34;space/rexhub/bj/test/*&#34;</span><span class="o">)</span> <span class="c1">// 不测试指定包
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span></code></pre></div><h2 id="gradle项目周期">Gradle项目周期<a hidden class="anchor" aria-hidden="true" href="#gradle项目周期">#</a></h2>
<ul>
<li>Initialization
<ul>
<li>Init Script: 执行init.gradle文件，包含仓库信息、仓库用户名密码等一些全局属性配置</li>
<li>Setting Script: 执行setting.gradle文件，构建参与项目的所有模块，setting.gradle包含项目信息</li>
</ul>
</li>
<li>Configuration：按照层级结构执行各个项目中的build.gradle文件，并更具层级关系创建一个Task有向无环图</li>
<li>execution：执行各个task节点的任务</li>
</ul>
<h2 id="settings文件">settings文件<a hidden class="anchor" aria-hidden="true" href="#settings文件">#</a></h2>
<ul>
<li>作用：初始化阶段确定哪些工程需要加入到项目构建中，为构建项目工程树做准备。</li>
<li>工程树：类似maven的module</li>
<li>位置：必须在根工程下</li>
<li>名字：必须为setting.gradle</li>
<li>内容：定义当前项目以及子项目的项目名称</li>
<li>对应实例：与package org.gradle.api.initialization.Settings一一对应</li>
<li>使用：使用相对路径【:】引入子工程。子工程必须在setting中配置了才会被gradle识别</li>
</ul>
<h2 id="task">Task<a hidden class="anchor" aria-hidden="true" href="#task">#</a></h2>
<blockquote>
<p>项目实质上是Task 对象的集合。一个 Task 表示一个逻辑上较为独立的执行过程，比如编译 Java 源代码，拷贝文件，打包 Jar 文件，甚至可以是执行一个系统命令。另外，一个 Task 可以读取和设置 Project 的 Property 以完成特定的操作。</p>
</blockquote>
<h3 id="简单使用">简单使用<a hidden class="anchor" aria-hidden="true" href="#简单使用">#</a></h3>
<ol>
<li>在build.gradle中</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kt">def</span> <span class="n">map</span> <span class="o">=</span> <span class="n">Collections</span><span class="o">.</span><span class="na">singletonMap</span><span class="o">(</span><span class="s2">&#34;action&#34;</span><span class="o">,</span> <span class="o">{</span><span class="n">println</span> <span class="s2">&#34;task one...&#34;</span><span class="o">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//task(map,  &#34;task1&#34;, {})
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">task</span> <span class="o">(</span><span class="n">map</span><span class="o">,</span> <span class="s2">&#34;task1&#34;</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 任务的配置段，在任务的配置阶段进行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">println</span> <span class="s2">&#34;这是最简单的任务&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 任务的行为：在任务执行阶段执行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">doFirst</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">println</span> <span class="s2">&#34;task1 do first&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">doLast</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">println</span> <span class="s2">&#34;task1 do last&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="n">task1</span><span class="o">.</span><span class="na">doFirst</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">println</span> <span class="s2">&#34;task1 do first(outer)&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="n">task1</span><span class="o">.</span><span class="na">doLast</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">println</span> <span class="s2">&#34;task1 do first(outer)&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><ol start="2">
<li>命令行执行gralde -i task1</li>
<li>输出</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">&gt; Configure
</span></span><span class="line"><span class="cl">....
</span></span><span class="line"><span class="cl">这是最简单的任务
</span></span><span class="line"><span class="cl">....
</span></span><span class="line"><span class="cl">&gt; Task :task1
</span></span><span class="line"><span class="cl">....
</span></span><span class="line"><span class="cl">task1 do first(outer)
</span></span><span class="line"><span class="cl">task1 do first
</span></span><span class="line"><span class="cl">task one...
</span></span><span class="line"><span class="cl">task1 do last
</span></span><span class="line"><span class="cl">task1 do first(outer)
</span></span></code></pre></div><h3 id="任务定义方式">任务定义方式<a hidden class="anchor" aria-hidden="true" href="#任务定义方式">#</a></h3>
<ol>
<li>task(): task(&lsquo;A&rsquo;, {&hellip;})、task &lsquo;A&rsquo; {&hellip;}、task(&lsquo;A&rsquo;){&hellip;}</li>
<li>tasks对象的create()/register(): tasks.create(&ldquo;E&rdquo;){&hellip;}、tasks.register(&quot;&hellip;&quot;)
<ol>
<li>register: 延迟创建，只有task被调用的时候才会创建
tips: 可使用defaultTasks()定义任务(在没有指定其他任务时执行的默认任务)</li>
</ol>
</li>
</ol>
<h3 id="任务的属性">任务的属性<a hidden class="anchor" aria-hidden="true" href="#任务的属性">#</a></h3>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>基于一个存在的Task来创建，类似继承</td>
<td>DefaultTask</td>
</tr>
<tr>
<td>overwrite</td>
<td>是否替换存在的Task，这个和type配合起来用</td>
<td>false</td>
</tr>
<tr>
<td>dependsOn</td>
<td>配置任务的依赖</td>
<td>[]</td>
</tr>
<tr>
<td>action</td>
<td>添加到任务中的一个Action或者一个闭包</td>
<td>null</td>
</tr>
<tr>
<td>description</td>
<td>配置任务的描述</td>
<td>null</td>
</tr>
<tr>
<td>group</td>
<td>配置任务的分组</td>
<td>null</td>
</tr>
<tr>
<td>enable</td>
<td>任务是否开启</td>
<td>true</td>
</tr>
<tr>
<td>timeout</td>
<td>任务执行的时间</td>
<td>(tasks never time out)</td>
</tr>
<tr>
<td>onlyIf</td>
<td>任务断言, 如：myClean.onlyIf(!project.hasProperties(&ldquo;clean&rdquo;))，执行:gradle myClean -Pclean 才会调用myClean的方法</td>
<td>null</td>
</tr>
</tbody>
</table>
<h3 id="tasks的方法">Tasks的方法<a hidden class="anchor" aria-hidden="true" href="#tasks的方法">#</a></h3>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
<th>用例</th>
</tr>
</thead>
<tbody>
<tr>
<td>findByName</td>
<td>根据任务名查找</td>
<td>tasks.findByName(&ldquo;myClean&rdquo;).doFirst({&hellip;})</td>
</tr>
<tr>
<td>findByPath</td>
<td>根据任务路径查找</td>
<td>tasks.findByName(&quot;:myClean&quot;).doFirst({&hellip;})</td>
</tr>
<tr>
<td>addRule</td>
<td>处理任务不存在异常</td>
<td>tasks.addRule(&ldquo;cleanRule&rdquo;){String taskName -&gt; task(taskName){println &ldquo;任务不存在&rdquo;} }</td>
</tr>
</tbody>
</table>
<h3 id="原理分析">原理分析<a hidden class="anchor" aria-hidden="true" href="#原理分析">#</a></h3>
<p>无论是定义任务自身的 action,还是添加的 doLast、doFirst 方法，其实底层都被放入到一个 Action 的 List中了，最初这个 action List 是空的，当我们设置了 action【任务自身的行为】,它先将 action 添加到列表中，此时列表中只有一个 action,后续执行 doFirst 的时候 doFirst 在 action 前面添加，执行 doLast 的时候 doLast 在 action 后面添加。doFirst永远添加在 actions List 的第一位，保证添加的 Action 在现有的 action List 元素的最前面；doLast 永远都是在 action List末尾添加，保证其添加的 Action 在现有的 action List 元素的最后面。一个往前面添加,一个往后面添加，最后这个 actionList 就按顺序形成了 doFirst、doSelf、doLast 三部分的 Actions,就达到 doFirst、doSelf、doLast 三部分的 Actions 顺序执行的目的</p>
<h3 id="任务的依赖方式dependson">任务的依赖方式：dependsOn<a hidden class="anchor" aria-hidden="true" href="#任务的依赖方式dependson">#</a></h3>
<ol>
<li>
<p>参数方式依赖
实例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">task</span> <span class="n">A</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">doLast</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">println</span> <span class="s2">&#34;TaskA...&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="n">B</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">doLast</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span> <span class="s2">&#34;TaskB...&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 参数方式依赖：dependsOn后面用冒号
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">task</span> <span class="s1">&#39;C&#39;</span> <span class="o">(</span><span class="nl">dependsOn:</span> <span class="o">[</span><span class="s1">&#39;A&#39;</span><span class="o">,</span> <span class="s1">&#39;B&#39;</span><span class="o">]){</span>
</span></span><span class="line"><span class="cl">  <span class="n">doLast</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">println</span> <span class="s2">&#34;TaskC...&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>输出：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; Task :A
</span></span><span class="line"><span class="cl">TaskA...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; Task :B
</span></span><span class="line"><span class="cl">TaskB...
</span></span><span class="line"><span class="cl">&gt; Task :C
</span></span><span class="line"><span class="cl">TaskC...
</span></span></code></pre></div></li>
<li>
<p>内部依赖
实例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">task</span> <span class="s1">&#39;A&#39;</span><span class="o">{...}</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="s1">&#39;B&#39;</span><span class="o">{...}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 参数方式依赖
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">task</span> <span class="s1">&#39;C&#39;</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 内部依赖：dependsOn后面=号
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">dependsOn</span><span class="o">=[</span><span class="s1">&#39;A&#39;</span><span class="o">,</span> <span class="s1">&#39;B&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="n">doLast</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">println</span> <span class="s2">&#34;TaskC.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>输出同上</p>
</li>
<li>
<p>外部依赖
实例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="c1">// 外部依赖：可变参数可加可不加
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">task</span> <span class="s1">&#39;A&#39;</span><span class="o">{...}</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="s1">&#39;B&#39;</span><span class="o">{...}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 参数方式依赖
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">task</span> <span class="s1">&#39;C&#39;</span><span class="o">{...}</span>
</span></span><span class="line"><span class="cl"><span class="n">C</span> <span class="nf">dependsOn</span><span class="o">(</span><span class="s1">&#39;B&#39;</span><span class="o">,</span> <span class="s1">&#39;A&#39;</span><span class="o">)</span>
</span></span></code></pre></div><p>输出同上</p>
</li>
</ol>
<p>tips：</p>
<ul>
<li>依赖支持跨项目依赖</li>
<li>当一个 Task 依赖多个 Task 的时候，被依赖的 Task 之间如果没有依赖关系，那么它们的执行顺序是随机的,并无影响</li>
<li>重复依赖的任务只会执行一次</li>
</ul>
<h3 id="任务类型官方更多点这httpsdocsgradleorgcurrentdslindexhtmln104d4">任务类型。<a href="https://docs.gradle.org/current/dsl/index.html#N104D4">官方(更多点这)</a><a hidden class="anchor" aria-hidden="true" href="#任务类型官方更多点这httpsdocsgradleorgcurrentdslindexhtmln104d4">#</a></h3>
<table>
<thead>
<tr>
<th>常见任务类型</th>
<th>该类型任务的作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Delete</td>
<td>删除文件或目录</td>
</tr>
<tr>
<td>Copy</td>
<td>将文件复制到目标目录中。此任务还可以在复制时重命名和筛选文件</td>
</tr>
<tr>
<td>CreateStartScripts</td>
<td>创建启动脚本</td>
</tr>
<tr>
<td>Exec</td>
<td>执行命令行进程</td>
</tr>
<tr>
<td>GenerateMavenPom</td>
<td>生成 Maven 模块描述符(POM)文件。</td>
</tr>
<tr>
<td>GradleBuild</td>
<td>执行 Gradle 构建</td>
</tr>
<tr>
<td>Jar</td>
<td>组装 JAR 归档文件</td>
</tr>
<tr>
<td>JavaCompile</td>
<td>编译 Java 源文件</td>
</tr>
<tr>
<td>Javadoc</td>
<td>为 Java 类生成 HTML API 文档</td>
</tr>
<tr>
<td>PublishToMavenRepository</td>
<td>将 MavenPublication 发布到 mavenartifactrepostal</td>
</tr>
<tr>
<td>Tar</td>
<td>组装 TAR 存档文件</td>
</tr>
<tr>
<td>Test</td>
<td>执行 JUnit (3.8.x、4.x 或 5.x)或 TestNG 测试</td>
</tr>
<tr>
<td>Upload</td>
<td>将 Configuration 的构件上传到一组存储库</td>
</tr>
<tr>
<td>War</td>
<td>组装 WAR 档案</td>
</tr>
<tr>
<td>Zip</td>
<td>组装 ZIP 归档文件。默认是压缩 ZIP 的内容</td>
</tr>
</tbody>
</table>
<h4 id="自定义类型的task">自定义类型的Task<a hidden class="anchor" aria-hidden="true" href="#自定义类型的task">#</a></h4>
<p>继承DefaultTask</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">CustomTask</span> <span class="kd">extends</span> <span class="n">DefaultTask</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"><span class="c1">//@TaskAction表示Task本身要执行的方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nd">@TaskAction</span>
</span></span><span class="line"><span class="cl">  <span class="kt">def</span> <span class="nf">doSelf</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">println</span> <span class="s2">&#34;Task自身在执行的in doSelf&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">def</span> <span class="n">myTask</span><span class="o">=</span><span class="n">task</span> <span class="n">MyDefinitionTask</span> <span class="o">(</span><span class="nl">type:</span> <span class="n">CustomTask</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">myTask</span><span class="o">.</span><span class="na">doFirst</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">println</span> <span class="s2">&#34;task 执行之前 执行的 doFirst方法&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span> 
</span></span><span class="line"><span class="cl"><span class="n">myTask</span><span class="o">.</span><span class="na">doLast</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">println</span> <span class="s2">&#34;task 执行之后 执行的 doLast方法&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="指定task执行顺序官方httpsdocsgradleorgcurrentdslorggradleapitaskhtmln18aa8">指定Task执行顺序。<a href="https://docs.gradle.org/current/dsl/org.gradle.api.Task.html#N18AA8">官方</a><a hidden class="anchor" aria-hidden="true" href="#指定task执行顺序官方httpsdocsgradleorgcurrentdslorggradleapitaskhtmln18aa8">#</a></h3>
<ol>
<li>dependsOn 强依赖方式</li>
<li>通过Task输入输出</li>
<li>通过API指定执行顺序</li>
</ol>
<h3 id="动态分配功能">动态分配功能。<a hidden class="anchor" aria-hidden="true" href="#动态分配功能">#</a></h3>
<ul>
<li>可循环创建任务，可以使用它在运行时动态地向任务添加依赖项
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="mi">4</span><span class="o">.</span><span class="na">times</span> <span class="o">{</span> <span class="n">counter</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">tasks</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="s2">&#34;task$counter&#34;</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">doLast</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">println</span> <span class="s2">&#34;I&#39;m task number $counter&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="n">tasks</span><span class="o">.</span><span class="na">named</span><span class="o">(</span><span class="s1">&#39;task0&#39;</span><span class="o">)</span> <span class="o">{</span> <span class="n">dependsOn</span><span class="o">(</span><span class="s1">&#39;task2&#39;</span><span class="o">,</span> <span class="s1">&#39;task3&#39;</span><span class="o">)</span> <span class="o">}</span>
</span></span></code></pre></div></li>
</ul>
<h2 id="插件">插件<a hidden class="anchor" aria-hidden="true" href="#插件">#</a></h2>
<h3 id="作用">作用<a hidden class="anchor" aria-hidden="true" href="#作用">#</a></h3>
<ul>
<li>添加任务【task】到项目中，从而帮助完成测试、编译、打包等</li>
<li>添加依赖配置到项目中。</li>
<li>向项目中拓展新的扩展属性、方法等</li>
<li>对项目进行一些约定，如应用 Java 插件后，约定 src/main/java 目录是我们的源代码存在位置，编译时编译这个目录下的 Java 源代码文件</li>
</ul>
<h3 id="分类">分类<a hidden class="anchor" aria-hidden="true" href="#分类">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">graph LR;
</span></span><span class="line"><span class="cl">A[gradle插件] --&gt; B[脚本插件]
</span></span><span class="line"><span class="cl">A --&gt; C[&#34;二进制插件(对象插件)&#34;]
</span></span><span class="line"><span class="cl">C --&gt; D[内部插件]
</span></span><span class="line"><span class="cl">C --&gt; E[第三方插件]
</span></span><span class="line"><span class="cl">C --&gt; F[自定义插件]
</span></span><span class="line"><span class="cl">D --&gt; G[apply方式]
</span></span><span class="line"><span class="cl">D --&gt; H[&#34;plugins DSL方式&#34;]
</span></span><span class="line"><span class="cl">G --&gt; I[&#34;apply(map具名参数)&#34;]
</span></span><span class="line"><span class="cl">G --&gt; J[&#34;apply闭包&#34;]
</span></span><span class="line"><span class="cl">E --&gt; K[传统使用方式]
</span></span><span class="line"><span class="cl">E --&gt; L[&#34;plugins DSL&#34;]
</span></span><span class="line"><span class="cl">K --&gt; M[&#34;1. 先引入依赖&#34;]
</span></span><span class="line"><span class="cl">K --&gt; N[&#34;2. 通过apply应用&#34;]
</span></span><span class="line"><span class="cl">F --&gt; O[构建过程中默认执行]
</span></span></code></pre></div><h4 id="脚本插件">脚本插件<a hidden class="anchor" aria-hidden="true" href="#脚本插件">#</a></h4>
<ol>
<li>编写脚本文件
version.gradle
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">ext</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">company</span> <span class="o">=</span> <span class="s2">&#34;Rexhub&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">cfgs</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&#34;compileSdkVersion&#34;</span><span class="o">:</span><span class="s2">&#34;JavaVersion.VERSION_1_S&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="n">spring</span> <span class="o">=</span> <span class="o">[</span>
</span></span><span class="line"><span class="cl">    <span class="nl">version:</span> <span class="s1">&#39;5.0.0&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></li>
<li>引入
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">task</span> <span class="n">versionTask</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">doLast</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">println</span> <span class="s2">&#34;公司名称为：${company},JDK版本是${cfgs.compileSdkVersion},版本号是${spring.version}&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></li>
</ol>
<p>执行脚本结果：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; Task :versionTask
</span></span><span class="line"><span class="cl">公司名称为：Rexhub,JDK版本是JavaVersion.VERSION_1_S,版本号是5.0.0
</span></span></code></pre></div><p>tips: 脚本文件可以是本地的，也可以是网络上的</p>
<h4 id="内部插件">内部插件<a hidden class="anchor" aria-hidden="true" href="#内部插件">#</a></h4>
<blockquote>
<p>二进制插件（对象插件）就是实现了 org.gradle.api.Plugin 接口的插件，每个 Java Gradle 插件都有一个 plugin id。<a href="https://docs.gradle.org/current/userguide/plugin_reference.html">核心插件(gradle官方)</a></p>
</blockquote>
<ul>
<li>apply方式引入
<ul>
<li>apply(map具名参数)
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="c1">//plugin: &#39;插件id/插件全类名/插件简类名&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">&#39;java&#39;</span> <span class="c1">//map具名参数方式
</span></span></span></code></pre></div></li>
<li>apply(闭包)
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">apply</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//plugin &#39;插件id/插件全类名/插件简类名&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">plugin</span> <span class="s1">&#39;java&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>plugins DSL
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">plugins</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">id</span> <span class="s1">&#39;java&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="n">id</span> <span class="s1">&#39;application&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="第三方插件">第三方插件<a hidden class="anchor" aria-hidden="true" href="#第三方插件">#</a></h3>
<ol>
<li>传统方式
<ol>
<li>引入依赖
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">buildscript</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">ext</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">springBootVersion</span> <span class="o">=</span> <span class="s2">&#34;2.3.3.RELEASE&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> 
</span></span><span class="line"><span class="cl">  <span class="n">repositories</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">mavenLocal</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">maven</span> <span class="o">{</span> <span class="n">url</span> <span class="s1">&#39;http://maven.aliyun.com/nexus/content/groups/public&#39;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">jcenter</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> 
</span></span><span class="line"><span class="cl">  <span class="c1">// 此处先引入插件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">dependencies</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">classpath</span><span class="o">(</span><span class="s2">&#34;org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div>tips:
<ul>
<li>但是如果是第三方插件已经被托管在 <a href="https://plugins.gradle.org/">https://plugins.gradle.org/</a> 网站上,就可以不用在buildscript里配置classpath依赖了</li>
<li>buildscript{}需要放在gradle文件最前面</li>
</ul>
</li>
<li>通过apply应用
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">&#39;org.springframework.boot&#39;</span> <span class="c1">//社区插件,需要事先引入，不必写版本号
</span></span></span></code></pre></div></li>
</ol>
</li>
<li>plugins DSL
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">plugins</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">id</span> <span class="s1">&#39;org.springframework.boot&#39;</span> <span class="n">version</span> <span class="s1">&#39;2.4.1&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="自定义插件">自定义插件<a hidden class="anchor" aria-hidden="true" href="#自定义插件">#</a></h3>
<h4 id="项目内简单定义方式这种方式一般不用">项目内简单定义方式(这种方式一般不用)<a hidden class="anchor" aria-hidden="true" href="#项目内简单定义方式这种方式一般不用">#</a></h4>
<p><a href="https://docs.gradle.org/current/userguide/custom_plugins.html">官方文档</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kd">interface</span> <span class="nc">GreetingPluginExtension</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Property</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">getMessage</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">  <span class="n">Property</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">getGreeter</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span> 
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">GreetingPlugin</span> <span class="kd">implements</span> <span class="n">Plugin</span><span class="o">&lt;</span><span class="n">Project</span><span class="o">&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="nf">apply</span><span class="o">(</span><span class="n">Project</span> <span class="n">project</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">def</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="na">extensions</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s1">&#39;greeting&#39;</span><span class="o">,</span> <span class="n">GreetingPluginExtension</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">project</span><span class="o">.</span><span class="na">task</span><span class="o">(</span><span class="s1">&#39;hello&#39;</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">doLast</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">println</span> <span class="s2">&#34;${extension.message.get()} from ${extension.greeter.get()}&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="n">apply</span> <span class="nl">plugin:</span> <span class="n">GreetingPlugin</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Configure the extension using a DSL block
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">greeting</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Hi&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="n">greeter</span> <span class="o">=</span> <span class="s1">&#39;Gradle&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="buildsrc方式">buildSrc方式<a hidden class="anchor" aria-hidden="true" href="#buildsrc方式">#</a></h4>
<blockquote>
<p>buildSrc 是 Gradle 默认的插件目录，编译 Gradle 的时候会自动识别这个目录，将其中的代码编译为插件</p>
</blockquote>
<h5 id="项目内方式">项目内方式<a hidden class="anchor" aria-hidden="true" href="#项目内方式">#</a></h5>
<ol>
<li>创建名为<strong>buildSrc</strong>的java module，在setting.gradle中移除included modules信息。只保留build.gradle和src/main目录</li>
<li>修改gradle中的内容
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">&#39;groovy&#39;</span> <span class="c1">//必须
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">&#39;maven-publish&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">dependencies</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">implementation</span> <span class="nf">gradleApi</span><span class="o">()</span> <span class="c1">//必须
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">implementation</span> <span class="nf">localGroovy</span><span class="o">()</span> <span class="c1">//必须
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="n">repositories</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">google</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">jcenter</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">mavenCentral</span><span class="o">()</span> <span class="c1">//必须
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//把项目入口设置为src/main/groovy
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">sourceSets</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">groovy</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">srcDir</span> <span class="s1">&#39;src/main/groovy&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></li>
<li>在src中创建入口目录，如：space.rexhub</li>
<li>在入口目录中创建插件，如：Text.groovy
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kn">package</span> <span class="n">space</span><span class="o">.</span><span class="na">rexhub</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.gradle.api.Plugin</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.gradle.api.Project</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">* Description: Text插件
</span></span></span><span class="line"><span class="cl"><span class="cm">* @author Rex
</span></span></span><span class="line"><span class="cl"><span class="cm">* @date 2022-11-06 15:26
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">Text</span> <span class="kd">implements</span> <span class="n">Plugin</span><span class="o">&lt;</span><span class="n">Project</span><span class="o">&gt;{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">apply</span><span class="o">(</span><span class="n">Project</span> <span class="n">project</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">project</span><span class="o">.</span><span class="na">task</span><span class="o">(</span><span class="s2">&#34;rexhub&#34;</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">doLast</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">println</span> <span class="s2">&#34;自定义插件使用&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></li>
<li>创建main/resources/META-INF/gradle-plugins目录，在这个目录下创建properties，文件名为插件id</li>
<li>在properties文件中指名插件的全类名
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> implementation-class=space.rexhub.Text
</span></span></code></pre></div></li>
</ol>
<p>tips: 这种方式可以跨模块调用，但仅限于本工程</p>
<h5 id="将项目上传至maven的方式">将项目上传至maven的方式<a hidden class="anchor" aria-hidden="true" href="#将项目上传至maven的方式">#</a></h5>
<p>基于上述步骤改进</p>
<ol>
<li>将buildSrc复制一份并重命名，如：rexhub，在setting.gradle引入</li>
<li>修改rexhub中的build.gradle文件，发布到仓库中
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">&#39;groovy&#39;</span> <span class="c1">//必须
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">&#39;maven-publish&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">dependencies</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">implementation</span> <span class="nf">gradleApi</span><span class="o">()</span> <span class="c1">//必须
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">implementation</span> <span class="nf">localGroovy</span><span class="o">()</span> <span class="c1">//必须
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="n">repositories</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">google</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">jcenter</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">mavenCentral</span><span class="o">()</span> <span class="c1">//必须
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//把项目入口设置为src/main/groovy
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">sourceSets</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">groovy</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">srcDir</span> <span class="s1">&#39;src/main/groovy&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="n">publishing</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">publications</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">myLibrary</span><span class="o">(</span><span class="n">MavenPublication</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">groupId</span> <span class="o">=</span> <span class="s1">&#39;space.rexhub.plugin&#39;</span> <span class="c1">//指定GAV坐标信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">artifactId</span> <span class="o">=</span> <span class="s1">&#39;library&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;1.1&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="n">from</span> <span class="n">components</span><span class="o">.</span><span class="na">java</span><span class="c1">//发布jar包
</span></span></span><span class="line"><span class="cl"><span class="c1">//from components.web///引入war插件，发布war包
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">repositories</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">maven</span> <span class="o">{</span> <span class="n">url</span> <span class="s2">&#34;$rootDir/lib/release&#34;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//发布项目到私服中
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// maven {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// name = &#39;myRepo&#39; //name属性可选,表示仓库名称，url必填
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// //发布地址:可以是本地仓库或者maven私服
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// //url = layout.buildDirectory.dir(&#34;repo&#34;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// //url=&#39;http://my.org/repo&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// // change URLs to point to your repos, e.g. http://my.org/repo
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// //认证信息:用户名和密码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// credentials {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// username = &#39;joe&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// password = &#39;secret&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></li>
<li>执行 publish 指令,发布到根 project 或者 maven 私服仓库。</li>
<li>使用：在项目级 build.gradle 文件中将插件添加到 classpath
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">buildscript</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">repositories</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">maven</span> <span class="o">{</span> <span class="n">url</span> <span class="s2">&#34;$rootDir/lib/release&#34;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">dependencies</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">classpath</span> <span class="s2">&#34;space.rexhub.plugin:library:1.1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="n">plugins</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">id</span> <span class="s1">&#39;java&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">id</span> <span class="s1">&#39;space.rexhub.plugin&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></li>
<li>执行 gradle build 指令就会在控制台看到自定义插件的输出，说明自定义插件就已经生效了</li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://rexhub.space/tags/build-tool/">Build Tool</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://rexhub.space/posts/back/java/framework/springboot/springboot%E9%85%8D%E7%BD%AE%E5%90%AF%E5%8A%A8/">
    <span class="title">Next Page »</span>
    <br>
    <span>SpringBoot配置启动</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Gradle构建工具 on twitter"
        href="https://twitter.com/intent/tweet/?text=Gradle%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7&amp;url=https%3a%2f%2frexhub.space%2fposts%2fback%2fjava%2fbuild_tool%2fgradle%2f&amp;hashtags=BuildTool">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Gradle构建工具 on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2frexhub.space%2fposts%2fback%2fjava%2fbuild_tool%2fgradle%2f&amp;title=Gradle%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7&amp;summary=Gradle%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7&amp;source=https%3a%2f%2frexhub.space%2fposts%2fback%2fjava%2fbuild_tool%2fgradle%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Gradle构建工具 on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2frexhub.space%2fposts%2fback%2fjava%2fbuild_tool%2fgradle%2f&title=Gradle%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Gradle构建工具 on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frexhub.space%2fposts%2fback%2fjava%2fbuild_tool%2fgradle%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Gradle构建工具 on whatsapp"
        href="https://api.whatsapp.com/send?text=Gradle%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7%20-%20https%3a%2f%2frexhub.space%2fposts%2fback%2fjava%2fbuild_tool%2fgradle%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Gradle构建工具 on telegram"
        href="https://telegram.me/share/url?text=Gradle%e6%9e%84%e5%bb%ba%e5%b7%a5%e5%85%b7&amp;url=https%3a%2f%2frexhub.space%2fposts%2fback%2fjava%2fbuild_tool%2fgradle%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
<script src="https://utteranc.es/client.js" repo="Rex0520/blogcomment"
  issue-term="title" theme="github-light" crossorigin="anonymous"
  async>
  </script>

</article>
    </main>
    
<footer class="footer">
  <span>&copy; 2022 <a href="https://rexhub.space/">Rex中心站</a></span>
  <span>
    Powered by
    <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
    <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
  </span>
  <span><a href="https://beian.miit.gov.cn/">浙ICP备2021016765号-2</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
    <path d="M12 6H0l6-6z" />
  </svg>
</a>

<script>
  let menu = document.getElementById('menu')
  menu.scrollLeft = localStorage.getItem("menu-scroll-position");
  menu.onscroll = function () {
    localStorage.setItem("menu-scroll-position", menu.scrollLeft);
  }

  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();
      var id = this.getAttribute("href").substr(1);
      if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
          behavior: "smooth"
        });
      } else {
        document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
      }
      if (id === "top") {
        history.replaceState(null, null, " ");
      } else {
        history.pushState(null, null, `#${id}`);
      }
    });
  });

</script>
<script>
  var mybutton = document.getElementById("top-link");
  window.onscroll = function () {
    if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
      mybutton.style.visibility = "visible";
      mybutton.style.opacity = "1";
    } else {
      mybutton.style.visibility = "hidden";
      mybutton.style.opacity = "0";
    }
  };

</script>
<script>
  document.getElementById("theme-toggle").addEventListener("click", () => {
    if (document.body.className.includes("dark")) {
      document.body.classList.remove('dark');
      localStorage.setItem("pref-theme", 'light');
    } else {
      document.body.classList.add('dark');
      localStorage.setItem("pref-theme", 'dark');
    }
  })

</script>
<script>
  document.querySelectorAll('pre > code').forEach((codeblock) => {
    const container = codeblock.parentNode.parentNode;

    const copybutton = document.createElement('button');
    copybutton.classList.add('copy-code');
    copybutton.innerText = 'copy';

    function copyingDone() {
      copybutton.innerText = 'copied!';
      setTimeout(() => {
        copybutton.innerText = 'copy';
      }, 2000);
    }

    copybutton.addEventListener('click', (cb) => {
      if ('clipboard' in navigator) {
        navigator.clipboard.writeText(codeblock.textContent);
        copyingDone();
        return;
      }

      const range = document.createRange();
      range.selectNodeContents(codeblock);
      const selection = window.getSelection();
      selection.removeAllRanges();
      selection.addRange(range);
      try {
        document.execCommand('copy');
        copyingDone();
      } catch (e) { };
      selection.removeRange(range);
    });

    if (container.classList.contains("highlight")) {
      container.appendChild(copybutton);
    } else if (container.parentNode.firstChild == container) {
      
    } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
      
      codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
    } else {
      
      codeblock.parentNode.appendChild(copybutton);
    }
  });
</script>

<script src="/assets/js/mermaid.min.js"></script>
<script>
  
  
  const mermaidKeywords = [
    "graph TD",
    "graph TB",
    "graph BT",
    "graph RL",
    "graph LR",
    "sequenceDiagram",
    "gantt",
    "classDiagram",
    "gitGraph",
    "erDiagram",
    "journey"
  ];
  var htmlCollection = document.getElementsByClassName('language-fallback')
  console.log(htmlCollection)
  Array.prototype.slice.call(htmlCollection)
  console.log(Array.prototype.slice.call(htmlCollection))
  Array.from(htmlCollection).forEach(ele => {
    var graphDefinition = ele.innerText;
    if (mermaidKeywords.some((keyword) => graphDefinition.startsWith(keyword))) {
      ele.parentElement.parentElement.outerHTML = `<div class="mermaid">${ele.innerText}</div>`
    }
  })
  Array.from(document.getElementsByClassName('language-mermaid')).forEach(ele => {
    ele.parentElement.outerHTML = `<div class="mermaid">${ele.innerText}</div>`
  })
</script>
<style>
   
  .mermaid svg {
    display: block;
    margin: auto;
  }
</style>
</body>

</html>
